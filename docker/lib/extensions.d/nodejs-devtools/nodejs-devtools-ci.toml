# nodejs-devtools-ci.toml - Minimal npm dev tools configuration for CI
# Lightweight config for CI/CD pipelines with memory optimization
# Requires nodejs to be installed first

[tools]
# Core npm development tools for CI testing
"npm:typescript" = "latest"
"npm:ts-node" = "latest"
"npm:eslint" = "latest"
"npm:@typescript-eslint/parser" = "latest"
"npm:@typescript-eslint/eslint-plugin" = "latest"
"npm:prettier" = "latest"
"npm:nodemon" = "latest"
"npm:goalie" = "latest"
"npm:research-swarm" = "latest"

[settings]
experimental = true
# Reduce verbosity in CI
verbose = false
# SEQUENTIAL installation to prevent memory competition (CI-only)
# Production uses jobs=2 for faster installs, CI prioritizes stability
jobs = 1

[env]
# Memory optimization for CI (6GB limit on 8GB VMs)
# Production uses 4GB default, CI needs higher limit for large packages
NODE_OPTIONS = "--max-old-space-size=6144"

# npm optimization flags for CI
npm_config_loglevel = "error"
npm_config_audit = "false"
npm_config_fund = "false"
npm_config_prefer_offline = "true"

# npm timeout configuration (in milliseconds)
# fetch-timeout: maximum time for a single package download (5 minutes)
# fetch-retries: number of times to retry failed downloads
# fetch-retry-mintimeout: minimum retry delay
# fetch-retry-maxtimeout: maximum retry delay
npm_config_fetch_timeout = "300000"
npm_config_fetch_retries = "2"
npm_config_fetch_retry_mintimeout = "10000"
npm_config_fetch_retry_maxtimeout = "60000"
# Overall npm install timeout (10 minutes)
npm_config_maxsockets = "10"
